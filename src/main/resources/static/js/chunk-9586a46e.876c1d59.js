(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9586a46e"],{"4e77":function(e,t,a){"use strict";var s=a("66eb"),r=a.n(s);r.a},"54f3":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("d2-container",[a("div",{staticClass:"personal"},[a("div",{staticClass:"personal-head"},[e._v(" 个人账户： ")]),a("div",{staticClass:"personal-main"},[a("div",{staticClass:"personal-main-right"},[a("div",{staticClass:"personal-username strip"},[a("div",{staticClass:"key"},[e._v("id：")]),a("div",{staticClass:"value"},[e._v(e._s(e.personalDetail.id))])]),a("div",{staticClass:"personal-name strip"},[a("div",{staticClass:"key"},[e._v("姓名：")]),a("div",{staticClass:"value"},[e._v(e._s(e.personalDetail.username))])]),a("div",{staticClass:"personal-role strip"},[a("div",{staticClass:"key"},[e._v("角色：")]),a("el-tag",{staticClass:"tags"},[e._v(e._s(e.personalDetail.roleDisplay))])],1),a("div",{staticClass:"persoanl-group strip"},[a("div",{staticClass:"key"},[e._v("班组号：")]),a("div",{staticClass:"value"},[e._v(" "+e._s(e.personalDetail.group)+" ")])]),a("div",{staticClass:"persoanl-group strip"},[a("div",{staticClass:"key"},[e._v("职位：")]),a("div",{staticClass:"value"},[e._v(" "+e._s(e.personalDetail.position)+" ")])]),a("div",{staticClass:"personal-tel strip"},[a("div",{staticClass:"key"},[e._v("电话：")]),a("div",{staticClass:"value"},[e._v(e._s(e.personalDetail.phoneNumber))])])])]),a("d2-module",[a("el-button",{attrs:{type:"primary"},on:{click:e.updatePwd}},[e._v("修改密码")])],1)],1),a("el-dialog",{attrs:{title:"修改密码",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"ruleForm",attrs:{model:e.formUpdatePwd,rules:e.rules}},[a("el-form-item",{attrs:{label:"原密码","label-width":e.formLabelWidth,prop:"originalPassword"}},[a("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.formUpdatePwd.originalPassword,callback:function(t){e.$set(e.formUpdatePwd,"originalPassword",t)},expression:"formUpdatePwd.originalPassword"}})],1),a("el-form-item",{attrs:{label:"新密码","label-width":e.formLabelWidth,prop:"newPassword"}},[a("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.formUpdatePwd.newPassword,callback:function(t){e.$set(e.formUpdatePwd,"newPassword",t)},expression:"formUpdatePwd.newPassword"}})],1),a("el-form-item",{attrs:{label:"确认新密码","label-width":e.formLabelWidth,prop:"checkPass"}},[a("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.formUpdatePwd.checkPass,callback:function(t){e.$set(e.formUpdatePwd,"checkPass",t)},expression:"formUpdatePwd.checkPass"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitUpdatePwd()}}},[e._v("确 定")])],1)],1)],1)},r=[],i=(a("96cf"),a("1da1")),o=a("5530"),l=a("365c"),n=a("5880"),d={name:"settings",data:function(){var e=this,t=function(t,a,s){""===a?s(new Error("请输入新密码")):(""!==e.formUpdatePwd.checkPass&&e.$refs.ruleForm.validateField("checkPass"),s())},a=function(t,a,s){""===a?s(new Error("请再次输入密码")):a!==e.formUpdatePwd.newPassword?s(new Error("两次输入密码不一致!")):s()};return{dialogFormVisible:!1,formLabelWidth:"140px",personalDetail:{},roleMap:{1:"系统管理员",2:"协作者",3:"访客"},formUpdatePwd:{id:0,originalPassword:"",newPassword:"",checkPass:""},rules:{originalPassword:[{required:!0,message:"请输入原密码",trigger:"blur"}],newPassword:[{validator:t,trigger:"blur"}],checkPass:[{validator:a,trigger:"blur"}]}}},computed:{},created:function(){this.getOwnerInfo()},methods:Object(o["a"])(Object(o["a"])({},Object(n["mapActions"])("d2admin/account",["logout"])),{},{getOwnerInfo:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l["a"].SYS_USER_OWN();case 2:a=t.sent,a&&(e.personalDetail=a,a.roleDisplay=e.roleMap[a.role]);case 4:case"end":return t.stop()}}),t)})))()},updatePwd:function(){var e=this.personalDetail.id;this.formUpdatePwd.id=e,this.dialogFormVisible=!0},logOff:function(){this.logout({confirm:!1})},submitUpdatePwd:function(){var e=this;this.$refs.ruleForm.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(a){var s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=8;break}return s=Object.assign({},e.formUpdatePwd),t.next=4,l["a"].SYS_USER_UPDATE_PWD(s);case 4:r=t.sent,r&&(e.dialogFormVisible=!1,e.$message.success("修改成功,即将登出"),setTimeout((function(){e.logOff()}),2e3)),t.next=9;break;case 8:return t.abrupt("return",!1);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}})},c=d,p=(a("4e77"),a("2877")),u=Object(p["a"])(c,s,r,!1,null,"7b6ba01d",null);t["default"]=u.exports},"66eb":function(e,t,a){}}]);